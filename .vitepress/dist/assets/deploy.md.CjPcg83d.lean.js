import{_ as n,c as Q,o as l,ag as i,j as s,a}from"./chunks/framework.C1nslR49.js";const e="/llm-finetune/assets/temperature.Dxu4LQNH.png",T="/llm-finetune/assets/beam_search.BGEFdaD1.png",h="/llm-finetune/assets/kv_cache.dAXjCvJF.png",p="/llm-finetune/assets/matmul.DqsfJXBK.png",r="/llm-finetune/assets/use_kv_cache.Dn_oYFQ7.png",d="/llm-finetune/assets/gmq_architecture.6wqWS_K_.png",o="/llm-finetune/assets/int8.DDZFbzy3.png",k="/llm-finetune/assets/logical_and_physical_block_table.Bqxh7Iew.png",m="/llm-finetune/assets/parallel_decoding.D-t2gDWc.png",g="/llm-finetune/assets/pipeline_parallel.Chz2Pv5G.png",c="/llm-finetune/assets/rag_index.Bawq2cvc.png",y="/llm-finetune/assets/rag_query.YdtIRDmC.png",E="/llm-finetune/assets/inference_metrics.CYaVVui9.png",u="/llm-finetune/assets/hw_scaling.CJNPwTI3.png",R1=JSON.parse('{"title":"部署","description":"","frontmatter":{},"headers":[],"relativePath":"deploy.md","filePath":"deploy.md"}'),L={name:"deploy.md"},F={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.844ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2141 1000","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.665ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2062 1000","aria-hidden":"true"},f={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.383ex",height:"5.23ex",role:"img",focusable:"false",viewBox:"0 -1351.5 5031.3 2311.5","aria-hidden":"true"},b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},_={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.899ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.78ex",height:"6.654ex",role:"img",focusable:"false",viewBox:"0 -1659.6 5206.8 2941.2","aria-hidden":"true"},V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677","aria-hidden":"true"},B={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677","aria-hidden":"true"},Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677","aria-hidden":"true"},G={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.959ex",height:"1.692ex",role:"img",focusable:"false",viewBox:"0 -666 6612 748","aria-hidden":"true"},N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.959ex",height:"1.717ex",role:"img",focusable:"false",viewBox:"0 -677 6612 759","aria-hidden":"true"},K={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"69.446ex",height:"5.475ex",role:"img",focusable:"false",viewBox:"0 -1460 30695 2420","aria-hidden":"true"},U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.912ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.827ex",height:"2.886ex",role:"img",focusable:"false",viewBox:"0 -872.7 14509.5 1275.7","aria-hidden":"true"},X={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.673ex",height:"5.475ex",role:"img",focusable:"false",viewBox:"0 -1460 12673.3 2420","aria-hidden":"true"},Y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453","aria-hidden":"true"},s1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},a1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},i1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.543ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2449.9 1000","aria-hidden":"true"},Q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.672ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2506.9 1000","aria-hidden":"true"},n1={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},e1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.308ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.549ex",height:"5.741ex",role:"img",focusable:"false",viewBox:"0 -1517.7 17922.7 2537.7","aria-hidden":"true"},T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.233ex",height:"2.343ex",role:"img",focusable:"false",viewBox:"0 -841.7 2312.8 1035.7","aria-hidden":"true"},p1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"36.201ex",height:"1.971ex",role:"img",focusable:"false",viewBox:"0 -677 16000.9 871","aria-hidden":"true"},d1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"28.533ex",height:"1.971ex",role:"img",focusable:"false",viewBox:"0 -677 12611.8 871","aria-hidden":"true"},k1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.222ex",height:"2.112ex",role:"img",focusable:"false",viewBox:"0 -893.3 4959.9 933.3","aria-hidden":"true"},g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.642ex",height:"2.112ex",role:"img",focusable:"false",viewBox:"0 -893.3 4703.8 933.3","aria-hidden":"true"},y1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.482ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 1981 636","aria-hidden":"true"},u1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.139ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4481.4 1000","aria-hidden":"true"},F1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.613ex",height:"1.946ex",role:"img",focusable:"false",viewBox:"0 -666 2481 860","aria-hidden":"true"},w1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"51.436ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -694 22734.7 899","aria-hidden":"true"},f1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.267ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 2328 705","aria-hidden":"true"},b1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.115ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -694 2703 899","aria-hidden":"true"},_1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.805ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 3008 705","aria-hidden":"true"},V1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.14ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.88ex",height:"1.71ex",role:"img",focusable:"false",viewBox:"0 -694 5251 756","aria-hidden":"true"},B1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.285ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -694 2778 899","aria-hidden":"true"};function Z1(q1,t,P1,S1,G1,j1){return l(),Q("div",null,[t[109]||(t[109]=i("",44)),s("p",null,[t[4]||(t[4]=a("Top-k 相比 Top-p 最大的好处是它不需要计算所有输出的 softmax，只需要找到前 k 个最大值，然后计算这 k 个值的 softmax，计算量从 ")),s("mjx-container",F,[(l(),Q("svg",H,t[0]||(t[0]=[i("",1)]))),t[1]||(t[1]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"O"),s("mo",{stretchy:"false"},"("),s("mi",null,"n"),s("mo",{stretchy:"false"},")")])],-1))]),t[5]||(t[5]=a(" 降到了 ")),s("mjx-container",w,[(l(),Q("svg",x,t[2]||(t[2]=[i("",1)]))),t[3]||(t[3]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"O"),s("mo",{stretchy:"false"},"("),s("mi",null,"k"),s("mo",{stretchy:"false"},")")])],-1))]),t[6]||(t[6]=a("。最新模型的词表都超过了 10 万，比如 Llama 3.1 有 13 万，因此使用 Top-k 可以大幅降低计算量。"))]),t[110]||(t[110]=s("p",null,"Top-k 和 Top-p 都能限制模型选择概率太小的 token，可以减少模型出错率。如果同时设置，会先使用 Top-k，然后再使用 Top-p。",-1)),t[111]||(t[111]=s("p",null,"Temperature 是在运行 softmax 函数前先除一下这个值，softmax 的公式是",-1)),s("mjx-container",f,[(l(),Q("svg",M,t[7]||(t[7]=[i("",1)]))),t[8]||(t[8]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("msub",null,[s("mi",null,"y"),s("mi",null,"i")]),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"e"),s("mrow",{"data-mjx-texclass":"ORD"},[s("msub",null,[s("mi",null,"x"),s("mi",null,"i")])])]),s("mrow",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("mrow",{"data-mjx-texclass":"ORD"},[s("msup",null,[s("mi",null,"e"),s("mrow",{"data-mjx-texclass":"ORD"},[s("msub",null,[s("mi",null,"x"),s("mi",null,"j")])])])])])])])],-1))]),s("p",null,[t[11]||(t[11]=a("Temperature 就是所有 ")),s("mjx-container",b,[(l(),Q("svg",C,t[9]||(t[9]=[i("",1)]))),t[10]||(t[10]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"x"),s("mi",null,"i")])])],-1))]),t[12]||(t[12]=a(" 除以这个值，公式变为如下"))]),s("mjx-container",_,[(l(),Q("svg",A,t[13]||(t[13]=[i("",1)]))),t[14]||(t[14]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("msub",null,[s("mi",null,"y"),s("mi",null,"i")]),s("mo",null,"="),s("mfrac",null,[s("msup",null,[s("mi",null,"e"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mfrac",null,[s("msub",null,[s("mi",null,"x"),s("mi",null,"i")]),s("mi",null,"T")])])]),s("mrow",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("msup",null,[s("mi",null,"e"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mfrac",null,[s("msub",null,[s("mi",null,"x"),s("mi",null,"j")]),s("mi",null,"T")])])])])])])],-1))]),s("p",null,[t[25]||(t[25]=a("其中的 ")),s("mjx-container",V,[(l(),Q("svg",D,t[15]||(t[15]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D447",d:"M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z",style:{"stroke-width":"3"}})])])],-1)]))),t[16]||(t[16]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"T")])],-1))]),t[26]||(t[26]=a(" 就是 temperature 值，它的作用是影响概率分布。我们可以想象一下，假设 ")),s("mjx-container",B,[(l(),Q("svg",v,t[17]||(t[17]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D447",d:"M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z",style:{"stroke-width":"3"}})])])],-1)]))),t[18]||(t[18]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"T")])],-1))]),t[27]||(t[27]=a(" 的值越大，每个 ")),s("mjx-container",Z,[(l(),Q("svg",q,t[19]||(t[19]=[i("",1)]))),t[20]||(t[20]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"x"),s("mi",null,"i")])])],-1))]),t[28]||(t[28]=a(" 除以它得到的值就越小，最后无限接近 0，每个值之间的差异变小。而 ")),s("mjx-container",P,[(l(),Q("svg",S,t[21]||(t[21]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D447",d:"M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z",style:{"stroke-width":"3"}})])])],-1)]))),t[22]||(t[22]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"T")])],-1))]),t[29]||(t[29]=a(" 如果小于 1，每个 ")),s("mjx-container",G,[(l(),Q("svg",j,t[23]||(t[23]=[i("",1)]))),t[24]||(t[24]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"x"),s("mi",null,"i")])])],-1))]),t[30]||(t[30]=a(" 的值就会成倍放大，加大它们之间的差异。"))]),t[112]||(t[112]=i("",19)),s("p",null,[t[35]||(t[35]=a("如果一开始选择概率最高的「A」，下一个 token 最高概率是 0.3，所以整体概率是 ")),s("mjx-container",I,[(l(),Q("svg",R,t[31]||(t[31]=[i("",1)]))),t[32]||(t[32]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"0.5"),s("mo",null,"∗"),s("mn",null,"0.3"),s("mo",null,"="),s("mn",null,"0.15")])],-1))]),t[36]||(t[36]=a("；而如果一开始选择概率次高的「B」，下一个 token 最高概率是 0.4，整体概率是 ")),s("mjx-container",N,[(l(),Q("svg",O,t[33]||(t[33]=[i("",1)]))),t[34]||(t[34]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"0.4"),s("mo",null,"∗"),s("mn",null,"0.4"),s("mo",null,"="),s("mn",null,"0.16")])],-1))]),t[37]||(t[37]=a("，所以选择概率最高并不一定能得到全局最优解。"))]),t[113]||(t[113]=i("",12)),s("mjx-container",K,[(l(),Q("svg",z,t[38]||(t[38]=[i("",1)]))),t[39]||(t[39]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mtext",null,"AI"),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mn",null,"2"),s("mo",null,"×"),s("mo",{stretchy:"false"},"("),s("mi",null,"M"),s("mo",null,"×"),s("mi",null,"N"),s("mo",null,"×"),s("mi",null,"K"),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("mn",null,"2"),s("mo",null,"×"),s("mo",{stretchy:"false"},"("),s("mi",null,"M"),s("mo",null,"×"),s("mi",null,"N"),s("mo",null,"+"),s("mi",null,"N"),s("mo",null,"×"),s("mi",null,"K"),s("mo",null,"+"),s("mi",null,"M"),s("mo",null,"×"),s("mi",null,"K"),s("mo",{stretchy:"false"},")")])]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("mi",null,"M"),s("mo",null,"×"),s("mi",null,"N"),s("mo",null,"×"),s("mi",null,"K")]),s("mrow",null,[s("mi",null,"M"),s("mo",null,"×"),s("mi",null,"N"),s("mo",null,"+"),s("mi",null,"N"),s("mo",null,"×"),s("mi",null,"K"),s("mo",null,"+"),s("mi",null,"M"),s("mo",null,"×"),s("mi",null,"K")])])])],-1))]),s("p",null,[t[42]||(t[42]=a("如果是一个 1024x4096 的矩阵和 4096x4096 的矩阵相乘，计算强度是 ")),s("mjx-container",U,[(l(),Q("svg",J,t[40]||(t[40]=[i("",1)]))),t[41]||(t[41]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mfrac",null,[s("mrow",null,[s("mn",null,"1024"),s("mo",null,"×"),s("mn",null,"4096"),s("mo",null,"×"),s("mn",null,"4096")]),s("mrow",null,[s("mn",null,"1024"),s("mo",null,"×"),s("mn",null,"4096"),s("mo",null,"+"),s("mn",null,"4096"),s("mo",null,"×"),s("mn",null,"4096"),s("mo",null,"+"),s("mn",null,"1024"),s("mo",null,"×"),s("mn",null,"4096")])]),s("mo",null,"="),s("mn",null,"682")])],-1))]),t[43]||(t[43]=a("，瓶颈是算力。"))]),t[114]||(t[114]=i("",22)),s("mjx-container",X,[(l(),Q("svg",W,t[44]||(t[44]=[i("",1)]))),t[45]||(t[45]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mi",null,"r"),s("mo",null,"∼"),s("mi",null,"U"),s("mo",{stretchy:"false"},"["),s("mn",null,"0"),s("mo",null,","),s("mn",null,"1"),s("mo",{stretchy:"false"},"]"),s("mspace",{linebreak:"newline"}),s("mi",null,"r"),s("mo",null,"<"),s("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min"),s("mo",{stretchy:"false"},"("),s("mn",null,"1"),s("mo",null,","),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"q"),s("mi",null,"i")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"x")]),s("mi",null,"i")]),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("msub",null,[s("mi",null,"p"),s("mi",null,"i")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"x")]),s("mi",null,"i")]),s("mo",{stretchy:"false"},")")])]),s("mo",{stretchy:"false"},")")])],-1))]),s("p",null,[t[54]||(t[54]=a("其中 ")),s("mjx-container",Y,[(l(),Q("svg",$,t[46]||(t[46]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D45F",d:"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)]))),t[47]||(t[47]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"r")])],-1))]),t[55]||(t[55]=a(" 取 0 到 1 之间正态分布的随机值，每个 token 验证时都随机获取，")),s("mjx-container",s1,[(l(),Q("svg",t1,t[48]||(t[48]=[i("",1)]))),t[49]||(t[49]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"x"),s("mi",null,"i")])])],-1))]),t[56]||(t[56]=a(" 是要验证的 token，")),s("mjx-container",a1,[(l(),Q("svg",i1,t[50]||(t[50]=[i("",1)]))),t[51]||(t[51]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"q"),s("mi",null,"i")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"x"),s("mi",null,"i")]),s("mo",{stretchy:"false"},")")])],-1))]),t[57]||(t[57]=a(" 是这个 token 在大参数模型中的概率，")),s("mjx-container",Q1,[(l(),Q("svg",l1,t[52]||(t[52]=[i("",1)]))),t[53]||(t[53]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"p"),s("mi",null,"i")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"x"),s("mi",null,"i")]),s("mo",{stretchy:"false"},")")])],-1))]),t[58]||(t[58]=a(" 是这个 token 在小模型中的概率，只要这个比值大于随机数 ")),t[59]||(t[59]=s("code",null,"r",-1)),t[60]||(t[60]=a(" 就接受这个 token，为什么这样计算？它的原理来自统计学中的拒绝采样（Rejection Sampling），在论文附录证明了这样计算后的概率相当于直接使用大模型输出的概率。"))]),t[115]||(t[115]=i("",47)),s("mjx-container",n1,[(l(),Q("svg",e1,t[61]||(t[61]=[i("",1)]))),t[62]||(t[62]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mi",null,"A"),s("mi",null,"t"),s("mi",null,"t"),s("mi",null,"e"),s("mi",null,"n"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"o"),s("mi",null,"n"),s("mo",{stretchy:"false"},"("),s("mi",null,"Q"),s("mo",null,","),s("mi",null,"K"),s("mo",null,","),s("mi",null,"V"),s("mo",{stretchy:"false"},")"),s("mo",null,"="),s("mi",null,"s"),s("mi",null,"o"),s("mi",null,"f"),s("mi",null,"t"),s("mi",null,"m"),s("mi",null,"a"),s("mi",null,"x"),s("mo",{stretchy:"false"},"("),s("mfrac",null,[s("mrow",null,[s("mi",null,"Q"),s("msup",null,[s("mi",null,"K"),s("mi",null,"T")])]),s("msqrt",null,[s("msub",null,[s("mi",null,"d"),s("mi",null,"k")])])]),s("mo",{stretchy:"false"},")"),s("mi",null,"V")])],-1))]),t[116]||(t[116]=i("",4)),s("p",null,[t[65]||(t[65]=a("因此 Q 和 K 相乘结果中的前 3 行和上一轮计算是一样的。同样，Q 矩阵和 K 转置相乘的结果我们也只需要最后一行，所以矩阵计算可以简化为如下，我们只需计算「座」这个 token 的 Q 和 K，然后加上之前计算过的 K 矩阵，就能继续计算 ")),s("mjx-container",T1,[(l(),Q("svg",h1,t[63]||(t[63]=[i("",1)]))),t[64]||(t[64]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"Q"),s("msup",null,[s("mi",null,"K"),s("mi",null,"T")])])],-1))]),t[66]||(t[66]=a(" 了。"))]),t[117]||(t[117]=s("p",null,[s("img",{src:r,alt:"使用 KV 缓存计算"})],-1)),s("p",null,[t[71]||(t[71]=a("因此使用 KV 缓存可以将之前的矩阵乘以矩阵变成向量乘以矩阵，大幅减少计算量。比如 Llama 2 7B 模型的 K 和 V 矩阵大小都是 4096x4096，如果输入文本有 32 个 token，矩阵所需浮点数计算量是 ")),s("mjx-container",p1,[(l(),Q("svg",r1,t[67]||(t[67]=[i("",1)]))),t[68]||(t[68]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"2"),s("mo",null,"∗"),s("mn",null,"32"),s("mo",null,"∗"),s("mn",null,"4096"),s("mo",null,"∗"),s("mn",null,"4096"),s("mo",null,"="),s("mn",null,"1"),s("mo",null,","),s("mn",null,"073"),s("mo",null,","),s("mn",null,"741"),s("mo",null,","),s("mn",null,"824")])],-1))]),t[72]||(t[72]=a("，而使用缓存后降低为 ")),s("mjx-container",d1,[(l(),Q("svg",o1,t[69]||(t[69]=[i("",1)]))),t[70]||(t[70]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"2"),s("mo",null,"∗"),s("mn",null,"4096"),s("mo",null,"∗"),s("mn",null,"4096"),s("mo",null,"="),s("mn",null,"33"),s("mo",null,","),s("mn",null,"554"),s("mo",null,","),s("mn",null,"432")])],-1))]),t[73]||(t[73]=a("，文本越长，差距越大。"))]),s("blockquote",null,[s("p",null,[t[84]||(t[84]=a("算力计算方法：矩阵 ")),s("mjx-container",k1,[(l(),Q("svg",m1,t[74]||(t[74]=[i("",1)]))),t[75]||(t[75]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"A"),s("mo",null,"∈"),s("msup",null,[s("mi",null,"R"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",{stretchy:"false"},"("),s("mi",null,"m"),s("mi",null,"×"),s("mi",null,"n"),s("mo",{stretchy:"false"},")")])])])],-1))]),t[85]||(t[85]=a(" 和矩阵 ")),s("mjx-container",g1,[(l(),Q("svg",c1,t[76]||(t[76]=[i("",1)]))),t[77]||(t[77]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"B"),s("mo",null,"∈"),s("msup",null,[s("mi",null,"R"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",{stretchy:"false"},"("),s("mi",null,"n"),s("mi",null,"×"),s("mi",null,"p"),s("mo",{stretchy:"false"},")")])])])],-1))]),t[86]||(t[86]=a(" 相乘需要进行 ")),s("mjx-container",y1,[(l(),Q("svg",E1,t[78]||(t[78]=[i("",1)]))),t[79]||(t[79]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"m"),s("mi",null,"n"),s("mi",null,"p")])],-1))]),t[87]||(t[87]=a(" 次乘法和 ")),s("mjx-container",u1,[(l(),Q("svg",L1,t[80]||(t[80]=[i("",1)]))),t[81]||(t[81]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"m"),s("mo",{stretchy:"false"},"("),s("mi",null,"n"),s("mo",null,"−"),s("mn",null,"1"),s("mo",{stretchy:"false"},")"),s("mi",null,"p")])],-1))]),t[88]||(t[88]=a(" 次加法，约等于 ")),s("mjx-container",F1,[(l(),Q("svg",H1,t[82]||(t[82]=[i("",1)]))),t[83]||(t[83]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"2"),s("mi",null,"m"),s("mi",null,"n"),s("mi",null,"p")])],-1))]),t[89]||(t[89]=a(" 次浮点数计算。"))])]),s("p",null,[t[102]||(t[102]=a("KV 缓存的缺点是占用大量显存，具体有多大？在 FP16 精度下，KV 缓存的计算方法是 ")),s("mjx-container",w1,[(l(),Q("svg",x1,t[90]||(t[90]=[i("",1)]))),t[91]||(t[91]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"2"),s("mo",null,"∗"),s("mn",null,"2"),s("mo",null,"∗"),s("mi",null,"b"),s("mi",null,"a"),s("mi",null,"t"),s("mi",null,"c"),s("mi",null,"h"),s("mo",null,"∗"),s("mi",null,"l"),s("mi",null,"a"),s("mi",null,"y"),s("mi",null,"e"),s("mi",null,"r"),s("mi",null,"s"),s("mo",null,"∗"),s("mi",null,"h"),s("mi",null,"e"),s("mi",null,"a"),s("mi",null,"d"),s("mi",null,"e"),s("mi",null,"r"),s("mo",null,"∗"),s("mi",null,"h"),s("mi",null,"e"),s("mi",null,"a"),s("mi",null,"d"),s("mi",null,"e"),s("mi",null,"r"),s("mi",{mathvariant:"normal"},"_"),s("mi",null,"d"),s("mi",null,"i"),s("mi",null,"m"),s("mo",null,"∗"),s("mi",null,"l"),s("mi",null,"e"),s("mi",null,"n"),s("mi",null,"g"),s("mi",null,"t"),s("mi",null,"h")])],-1))]),t[103]||(t[103]=a("，其中第一个 2 是 FP16 精度，第二个 2 是 K 和 V 两个，")),s("mjx-container",f1,[(l(),Q("svg",M1,t[92]||(t[92]=[i("",1)]))),t[93]||(t[93]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"b"),s("mi",null,"a"),s("mi",null,"t"),s("mi",null,"c"),s("mi",null,"h")])],-1))]),t[104]||(t[104]=a(" 是批量大小，")),s("mjx-container",b1,[(l(),Q("svg",C1,t[94]||(t[94]=[i("",1)]))),t[95]||(t[95]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"l"),s("mi",null,"a"),s("mi",null,"y"),s("mi",null,"e"),s("mi",null,"r"),s("mi",null,"s")])],-1))]),t[105]||(t[105]=a(" 是层数量、")),s("mjx-container",_1,[(l(),Q("svg",A1,t[96]||(t[96]=[i("",1)]))),t[97]||(t[97]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"h"),s("mi",null,"e"),s("mi",null,"a"),s("mi",null,"d"),s("mi",null,"e"),s("mi",null,"r")])],-1))]),t[106]||(t[106]=a(" 是头数量，")),s("mjx-container",V1,[(l(),Q("svg",D1,t[98]||(t[98]=[i("",1)]))),t[99]||(t[99]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"h"),s("mi",null,"e"),s("mi",null,"a"),s("mi",null,"d"),s("mi",null,"e"),s("mi",null,"r"),s("mi",{mathvariant:"normal"},"_"),s("mi",null,"d"),s("mi",null,"i"),s("mi",null,"m")])],-1))]),t[107]||(t[107]=a(" 是头维度、")),s("mjx-container",B1,[(l(),Q("svg",v1,t[100]||(t[100]=[i("",1)]))),t[101]||(t[101]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"l"),s("mi",null,"e"),s("mi",null,"n"),s("mi",null,"g"),s("mi",null,"t"),s("mi",null,"h")])],-1))]),t[108]||(t[108]=a(" 是输入和输出文本长度总和。"))]),t[118]||(t[118]=i("",163))])}const N1=n(L,[["render",Z1]]);export{R1 as __pageData,N1 as default};
