import{_ as e,c as i,o as n,ag as t,j as s,a as l}from"./chunks/framework.C1nslR49.js";const p="/llm-finetune/assets/apple_intelligence_overview.Cx_9MB71.png",C=JSON.parse('{"title":"微调实践","description":"","frontmatter":{},"headers":[],"relativePath":"practice.md","filePath":"practice.md"}'),h={name:"practice.md"},T={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.038ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 1785 705","aria-hidden":"true"},r={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"51.25ex",height:"5.475ex",role:"img",focusable:"false",viewBox:"0 -1460 22652.7 2420","aria-hidden":"true"},k={tabindex:"0",class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"60.521ex",height:"5.475ex",role:"img",focusable:"false",viewBox:"0 -1460 26750.4 2420","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.509ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -694 2435 888","aria-hidden":"true"};function E(c,a,y,u,F,H){return n(),i("div",null,[a[13]||(a[13]=t("",34)),s("p",null,[a[2]||(a[2]=s("strong",null,"DPO 偏好对齐",-1)),a[3]||(a[3]=l("，在 SFT 微调之后，LLaMA 3 进行了 DPO 偏好优化，训练数据使用之前训练奖励模型时的排序，学习率是 1e-5，")),s("mjx-container",T,[(n(),i("svg",Q,a[0]||(a[0]=[t("",1)]))),a[1]||(a[1]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"b"),s("mi",null,"e"),s("mi",null,"t"),s("mi",null,"a")])],-1))]),a[4]||(a[4]=l(" 超参数是 0.1，除了 DPO 也试验过 PPO 训练，但发现 DPO 计算量小，效果也不错，所以就只用 DPO 了。"))]),a[14]||(a[14]=t("",91)),s("mjx-container",r,[(n(),i("svg",d,a[5]||(a[5]=[t("",1)]))),a[6]||(a[6]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mtext",null,"DPO"),s("mo",null,"="),s("mo",null,"−"),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mi",null,"σ"),s("mrow",{"data-mjx-texclass":"INNER"},[s("mo",{"data-mjx-texclass":"OPEN"},"("),s("mi",null,"β"),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mi",null,"θ")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"w")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mtext",null,"ref")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"w")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")])]),s("mo",null,"−"),s("mi",null,"β"),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mi",null,"θ")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"l")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mtext",null,"ref")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"l")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")])]),s("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))]),s("mjx-container",k,[(n(),i("svg",o,a[7]||(a[7]=[t("",1)]))),a[8]||(a[8]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mtext",null,"LN-DPO"),s("mo",null,"="),s("mo",null,"−"),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mi",null,"σ"),s("mrow",{"data-mjx-texclass":"INNER"},[s("mo",{"data-mjx-texclass":"OPEN"},"("),s("mfrac",null,[s("mi",null,"β"),s("mrow",null,[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("msub",null,[s("mi",null,"y"),s("mi",null,"w")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mi",null,"θ")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"w")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mtext",null,"ref")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"w")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")])]),s("mo",null,"−"),s("mfrac",null,[s("mi",null,"β"),s("mrow",null,[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("msub",null,[s("mi",null,"y"),s("mi",null,"l")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mi",null,"θ")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"l")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("msub",null,[s("mi",null,"π"),s("mtext",null,"ref")]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"l")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",{stretchy:"false"},")")])]),s("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1))]),a[15]||(a[15]=t("",116)),s("p",null,[a[11]||(a[11]=l("其中 CFData-CP、CFData-CA 和 CFData-RR 主要是 PDF 格式，使用 PDFMiner 转换成文本格式，并使用正则去掉文档中的所有图形、表格和乱码，过滤掉小于 1000 字符的文档。其余三个数据源为网页数据，使用 HTML 解析器提取。由于这部分数据质量较差，因此进行了敏感词过滤，敏感词来自 PanGu-")),s("mjx-container",g,[(n(),i("svg",m,a[9]||(a[9]=[t("",1)]))),a[10]||(a[10]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"a"),s("mi",null,"l"),s("mi",null,"p"),s("mi",null,"h"),s("mi",null,"a")])],-1))]),a[12]||(a[12]=l("，而维基百科还将繁体中文转成简体，并对这些文档使用 LSH 算法进行去重。"))]),a[16]||(a[16]=t("",5))])}const L=e(h,[["render",E]]);export{C as __pageData,L as default};
